<section
  aria-label="List of comments"
  class="comments align-items flex flex-col items-center justify-center gap-[16px] py-2 md:gap-[24px]"
>
  @for (
    comment of store.comments();
    track `${comment.id}-${comment.status ?? ''}-${comment.score}`;
    let idx1 = $index
  ) {
    <app-comment-card
      class="self-stretch px-[17px]"
      [attr.data-cy]="`Comment id:${comment.id}`"
      [idx1]="idx1"
      [comment]="comment"
      [currentUser]="store.currentUser()"
    />

    @if (comment.replies && comment.replies!.length > 0) {
      <div class="w-full" aria-label="List of replies">
        <div
          class="comments-replies align-items flex flex-col items-center justify-center gap-[16px] self-stretch md:gap-[24px]"
        >
          @for (
            reply of comment.replies;
            track `${reply.id}-${reply.status ?? ''}-${reply.score}`;
            let idx2 = $index
          ) {
            <app-comment-card
              class="self-stretch pl-[17px]"
              [attr.data-cy]="`Reply to comment id:${comment.id}`"
              [idx1]="idx1"
              [idx2]="idx2"
              [comment]="reply"
              [isReply]="true"
              [currentUser]="store.currentUser()"
            />
          }
        </div>
      </div>
    }
  }

  <app-comment-card
    class="self-stretch px-[17px]"
    data-cy="Send new comment"
    [initialStatus]="CommentStatus.SEND"
    [currentUser]="store.currentUser()"
  />
</section>
